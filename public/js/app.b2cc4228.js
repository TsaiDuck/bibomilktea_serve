(function(){"use strict";var t={3677:function(t,e,o){var i=o(6369),s=function(){var t=this,e=t._self._c;return e("div",{ref:"app",staticClass:"app",attrs:{id:"app"}},[e("router-view")],1)},a=[],r={data(){return{windowWidth:window.innerWidth+"px",windowHeight:window.innerHeight-1+"px"}},mounted(){this.$refs.app.style.width=window.innerWidth+"px",this.$refs.app.style.height=document.documentElement.clientHeight-1+"px";const t=this;window.onresize=()=>(()=>{t.windowWidth=window.innerWidth+"px",t.windowHeight=window.innerHeight-1+"px"})()},watch:{windowWidth(){if(!this.timer){this.timer=!0;let t=this;setTimeout((function(){t.$refs.app.style.width=t.windowWidth,t.timer=!1}),500)}},windowHeight(){if(!this.timer){this.timer=!0;let t=this;setTimeout((function(){t.$refs.app.style.height=t.windowHeight,t.timer=!1}),500)}}},beforeDestroy(){this.$socket&&this.$socket.close()}},n=r,d=o(1001),c=(0,d.Z)(n,s,a,!1,null,null,null),l=c.exports,g=o(2631),u=(o(7658),o(3822));i["default"].use(u.ZP);var h=new u.ZP.Store({state:{user:{root:0},cart:[]},getters:{},mutations:{doLogin(t,e){t.user=e},doLogout(t){t.user={root:0}},addCart(t,e){t.cart.push(e)},addCount(t,e){t.cart[e].count++},reduceCount(t,e){1==t.cart[e].count?t.cart.splice(e,1):t.cart[e].count--},clearCart(t){t.cart=[]}},actions:{},modules:{}}),p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login"},[e("div",{staticClass:"login-content"},[e("img",{attrs:{src:o(1695)}}),e("div",{staticClass:"login-box"},[e("h3",[t._v("碧波奶茶管理系统")]),e("div",[e("span",[t._v("账户：")]),e("el-input",{staticStyle:{width:"240px"},attrs:{label:"账户",placeholder:"请输入账户"},model:{value:t.account.user_phone,callback:function(e){t.$set(t.account,"user_phone",e)},expression:"account.user_phone"}})],1),e("div",[e("span",[t._v("密码：")]),e("el-input",{staticStyle:{width:"240px"},attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.account.user_pwd,callback:function(e){t.$set(t.account,"user_pwd",e)},expression:"account.user_pwd"}})],1),e("el-button",{attrs:{type:"warning"},on:{click:t.login}},[t._v("登录")])],1)])])},_=[],v={data(){return{account:{user_phone:"",user_pwd:""}}},methods:{...(0,u.OI)(["doLogin"]),async login(){const{data:t}=await this.$http.post("/api/user/login",this.account);return 201==t.meta.status?this.$showMsg("账号或密码错误，请重新输入","登陆失败"):500==t.meta.status?this.$showMsg():t.data.user.user_root<1?this.$showMsg("很抱歉，您的权限不足","登陆失败"):(this.doLogin(t.data.user),void this.$router.push("/manage"))}},mounted(){}},f=v,m=(0,d.Z)(f,p,_,!1,null,"72c6c446",null),w=m.exports,C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"manage"},[e("navbar"),e("div",{staticClass:"manage-content"},[e("sidebar",{style:{height:t.windowHeight-70+"px"}}),e("div",{staticClass:"manage-box",style:{width:t.windowWidth-120+"px",height:t.windowHeight-70+"px"}},[e("router-view")],1)],1)],1)},b=[],y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"navbar"},[t._m(0),e("b",{staticClass:"el-icon-switch-button",attrs:{title:"退出"},on:{click:t.logout}})])},k=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"left"},[e("img",{staticClass:"navbar-img",attrs:{src:o(1703)}}),e("i",[t._v("碧波奶茶管理")])])}],x={methods:{...(0,u.OI)(["doLogout"]),logout(){this.doLogout(),this.$router.push("/login")}}},O=x,$=(0,d.Z)(O,y,k,!1,null,"6304fec8",null),S=$.exports,L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sidebar"},[e("div",{staticClass:"sidebar-item"},[e("span",{class:["screen"==t.active?"active":""],attrs:{title:"大屏幕"},on:{click:function(e){return t.navigatorTo("/manage/screen")}}},[t._v("大屏幕")])]),e("div",{staticClass:"sidebar-item"},[e("span",{class:["purchase"==t.active?"active":""],attrs:{title:"点餐"},on:{click:function(e){return t.navigatorTo("/manage/purchase")}}},[t._v("点餐")])]),e("div",{staticClass:"sidebar-item"},[e("span",{class:["order"==t.active?"active":""],attrs:{title:"订单"},on:{click:function(e){return t.navigatorTo("/manage/order")}}},[t._v("订单")])]),e("div",{staticClass:"sidebar-item"},[e("span",{class:["good"==t.active?"active":""],attrs:{title:"商品管理"},on:{click:function(e){return t.navigatorTo("/manage/good")}}},[t._v("商品管理")])])])},z=[],I={data(){return{active:this.$route.path.split("/")[2]}},methods:{navigatorTo(t){const e=t.split("/");this.active=e[2],this.$router.push(t)}}},T=I,D=(0,d.Z)(T,L,z,!1,null,"4913e009",null),H=D.exports,V={components:{sidebar:H,navbar:S},data(){return{windowWidth:window.innerWidth,windowHeight:window.innerHeight-1}}},Z=V,G=(0,d.Z)(Z,C,b,!1,null,"8aab42fc",null),A=G.exports,M=function(){var t=this,e=t._self._c;return e("div",{staticClass:"screen"},[e("div",{staticClass:"screen-item"},[e("h1",[t._v("排队中")]),e("br"),t._l(t.orderList.filter((t=>"已下单"==t.order_state)),(function(o){return e("span",{key:o.order_id},[t._v(t._s(o.order_dayId))])}))],2),e("div",{staticClass:"screen-item"},[e("h1",[t._v("制作中")]),e("br"),t._l(t.orderList.filter((t=>"制作中"==t.order_state)),(function(o){return e("span",{key:o.order_id},[t._v(t._s(o.order_dayId))])}))],2),e("div",{staticClass:"screen-item",staticStyle:{"border-right":"0"}},[e("h1",[t._v("待取餐")]),e("br"),t._l(t.orderList.filter((t=>"待取餐"==t.order_state)),(function(o){return e("span",{key:o.order_id},[t._v(t._s(o.order_dayId))])}))],2)])},j=[],P={data(){return{orderList:[]}},methods:{async getOrderList(){const{data:t}=await this.$http.get("/api/today/order");this.orderList=t.data}},mounted(){this.getOrderList()},sockets:{newOrder(){this.getOrderList()}}},W=P,F=(0,d.Z)(W,M,j,!1,null,"3e548426",null),E=F.exports,q=function(){var t=this,e=t._self._c;return e("div",{ref:"order",staticClass:"order"},[e("div",{staticClass:"order-selector"},[e("div",{class:["selector-item","underway"==t.active?"active":""],on:{click:function(e){return t.changeActive("underway")}}},[t._v(" 进行中订单 ")]),e("div",{class:["selector-item","finished"==t.active?"active":""],on:{click:function(e){return t.changeActive("finished")}}},[t._v(" 已完成订单 ")]),e("div",{class:["selector-item","history"==t.active?"active":""],on:{click:function(e){return t.changeActive("history")}}},[t._v(" 历史订单 ")])]),e("div",{staticClass:"order-box"},[e("div",{staticClass:"order-title"},[e("span",{staticClass:"order-space"}),e("div",{staticClass:"order-title-item"},[t._v("订单号")]),e("div",{staticClass:"order-title-item"},[t._v("下单时间")]),e("div",{staticClass:"order-title-item"},[t._v("订单状态")]),e("div",{staticClass:"order-title-item"},[t._v("操作")]),"history"==t.active?e("div",{staticClass:"search"},[e("el-input",{attrs:{size:"small",placeholder:"请输入订单号"},on:{input:t.getSearchOrder},model:{value:t.searchOrderVal,callback:function(e){t.searchOrderVal=e},expression:"searchOrderVal"}})],1):t._e()]),e("div",{staticClass:"order-content",style:{height:"history"==t.active?t.boxHeight-45+"px":t.boxHeight+"px"}},[t._l(t.orderListToday.filter((t=>"已下单"==t.order_state||"制作中"==t.order_state||"待取餐"==t.order_state)),(function(o){return"underway"==t.active?e("order",{key:o.order_id,attrs:{orderInfo:o},on:{stateChange:function(e){return t.stateChange(e)}}}):t._e()})),t._l(t.orderListToday.filter((t=>"已完成"==t.order_state||"已取消"==t.order_state)),(function(o){return"finished"==t.active?e("order",{key:o.order_id,attrs:{orderInfo:o},on:{stateChange:function(e){return t.stateChange(e)}}}):t._e()})),t._l(t.orderListHistory,(function(o){return"history"==t.active?e("historyOrder",{key:o.order_id,attrs:{orderInfo:o}}):t._e()}))],2)]),"history"==t.active?e("div",{staticClass:"page-selector"},[e("span",{staticClass:"el-icon-arrow-left",staticStyle:{cursor:"pointer"},on:{click:t.deletePage}}),e("span",[t._v(t._s(t.getAllOrderVal.page))]),e("span",{staticClass:"el-icon-arrow-right",staticStyle:{cursor:"pointer"},on:{click:t.addPage}})]):t._e()])},B=[],R=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-item"},[e("div",{staticClass:"order-list"},[e("b",{class:[1==t.showDetail?"el-icon-arrow-down":"el-icon-arrow-right"],staticStyle:{cursor:"pointer",display:"block",width:"20px"},attrs:{title:"查看详情"},on:{click:t.openDetail}}),e("span",[t._v(t._s(t.orderInfo.order_dayId))]),e("span",[t._v(t._s(t.orderInfo.order_time.split(" ")[1]))]),e("span",[t._v(t._s(t.orderInfo.order_state))]),e("span",{class:["已完成"==t.orderInfo.order_state?"":"operate"],attrs:{title:t.operate},on:{click:t.changeState}},[t._v(t._s(t.operate))])]),t.showDetail?e("div",{staticClass:"order-info"},[e("div",{staticClass:"info-left"},[e("div",{staticClass:"info-item"},[e("span",[t._v("订单编号：")]),e("span",[t._v(t._s(t.orderInfo.order_id))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("取餐方式：")]),e("span",[t._v(t._s(t.orderInfo.order_take_way))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("商品数量：")]),e("span",[t._v(t._s(t.orderInfo.order_count))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("实付价格：")]),e("span",[t._v(t._s(t.orderInfo.order_price.toFixed(2)))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("订单备注：")]),e("span",[t._v(t._s(t.orderInfo.order_info))])]),t._m(0)]),e("div",{staticClass:"info-right"},t._l(t.cart,(function(o){return e("div",{key:o.cart_id,staticClass:"right-item"},[e("span",{staticStyle:{"margin-right":"16px"}},[t._v(t._s(o.good_count)+"杯"+t._s(o.good_name))]),e("span",[t._v(t._s(o.good_size)+"/"+t._s(o.good_ice)+"/"+t._s(o.good_sugar)),""!==o.good_etc?e("span",[t._v("/"+t._s(o.good_etc))]):t._e()])])})),0)]):t._e()])},U=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-item"},[e("span",[t._v("订单详情：")])])}],N={props:{orderInfo:{type:Object}},data(){return{operate:"开始制作",showDetail:!1,cart:[]}},methods:{async changeState(){if("已完成"==this.orderInfo.order_state)return;let t;switch(this.operate){case"开始制作":t="制作中",this.operate="制作完成";break;case"制作完成":t="待取餐",this.operate="取餐完成";break;case"取餐完成":t="已完成",this.operate="订单已完成";break;default:break}const{data:e}=await this.$http.get(`/api/update/order?order_id=${this.orderInfo.order_id}&order_state=${t}`);this.$emit("stateChange",{order_id:this.orderInfo.order_id,state:t})},async openDetail(){if(this.showDetail=!this.showDetail,0!==this.cart.length)return;const{data:t}=await this.$http.get(`/api/orderid/cart?order_id=${this.orderInfo.order_id}`);if(200!==t.meta.status)return this.$showMsg();this.cart=t.data}},mounted(){switch(this.orderInfo.order_state){case"已下单":this.operate="开始制作";break;case"制作中":this.operate="制作完成";break;case"待取餐":this.operate="取餐完成";break;case"已完成":this.operate="订单已完成";break;case"已取消":this.operate="订单已取消";break}}},J=N,K=(0,d.Z)(J,R,U,!1,null,"cd6ec858",null),Q=K.exports,X=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-item"},[e("div",{staticClass:"order-list"},[e("b",{class:[1==t.showDetail?"el-icon-arrow-down":"el-icon-arrow-right"],staticStyle:{cursor:"pointer",display:"block",width:"20px"},attrs:{title:"查看详情"},on:{click:t.openDetail}}),e("span",[t._v(t._s(t.orderInfo.order_id))]),e("span",[t._v(t._s(t.orderInfo.order_time))]),e("span",[t._v(t._s(t.orderInfo.order_state))]),e("span",[t._v(t._s(t.operate))])]),t.showDetail?e("div",{staticClass:"order-info"},[e("div",{staticClass:"info-left"},[e("div",{staticClass:"info-item"},[e("span",[t._v("订单编号：")]),e("span",[t._v(t._s(t.orderInfo.order_id))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("取餐方式：")]),e("span",[t._v(t._s(t.orderInfo.order_take_way))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("商品数量：")]),e("span",[t._v(t._s(t.orderInfo.order_count))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("实付价格：")]),e("span",[t._v(t._s(t.orderInfo.order_price.toFixed(2)))])]),e("div",{staticClass:"info-item"},[e("span",[t._v("订单备注：")]),e("span",[t._v(t._s(t.orderInfo.order_info))])]),t._m(0)]),e("div",{staticClass:"info-right"},t._l(t.cart,(function(o){return e("div",{key:o.cart_id,staticClass:"right-item"},[e("span",{staticStyle:{"margin-right":"16px"}},[t._v(t._s(o.good_count)+"杯"+t._s(o.good_name))]),e("span",[t._v(t._s(o.good_size)+"/"+t._s(o.good_ice)+"/"+t._s(o.good_sugar)),""!==o.good_etc?e("span",[t._v("/"+t._s(o.good_etc))]):t._e()])])})),0)]):t._e()])},Y=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-item"},[e("span",[t._v("订单详情：")])])}],tt={props:{orderInfo:{type:Object}},data(){return{operate:"订单已完成",showDetail:!1,cart:[]}},methods:{async openDetail(){if(this.showDetail=!this.showDetail,0!==this.cart.length)return;const{data:t}=await this.$http.get(`/api/orderid/cart?order_id=${this.orderInfo.order_id}`);if(200!==t.meta.status)return this.$showMsg();this.cart=t.data}},mounted(){switch(this.orderInfo.order_state){case"已下单":this.operate="开始制作";break;case"制作中":this.operate="制作完成";break;case"待取餐":this.operate="取餐完成";break;case"已完成":this.operate="订单已完成";break;case"已取消":this.operate="订单已取消";break}}},et=tt,ot=(0,d.Z)(et,X,Y,!1,null,"10f9e040",null),it=ot.exports,st={components:{order:Q,historyOrder:it},data(){return{active:"underway",orderListToday:[],orderListHistory:[],getAllOrderVal:{limit:12,page:1},boxHeight:0,searchOrderVal:"",timeout:null,webSock:null}},methods:{changeActive(t){this.active=t},async getTodayOrder(){const{data:t}=await this.$http.get("/api/today/order");this.orderListToday=t.data},async getOrderList(){const{data:t}=await this.$http({method:"post",url:"/api/get/allOrder",data:this.getAllOrderVal});this.orderListHistory=t.data},stateChange(t){const e=this.orderListToday.findIndex((e=>e.order_id==t.order_id));this.orderListToday[e].order_state=t.state},addPage(){this.orderListHistory.length<this.getAllOrderVal.limit||(this.getAllOrderVal.page++,this.getOrderList())},deletePage(){1!=this.getAllOrderVal.page&&(this.getAllOrderVal.page--,this.getOrderList())},getSearchOrder(){""==this.searchOrderVal?this.getOrderList():(null!==this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.getSearchOrderList.apply(this)}),800))},async getSearchOrderList(){const{data:t}=await this.$http.get(`/api/get/order/orderid?order_id=${this.searchOrderVal}`);if(200!==t.meta.status)return this.$showMsg();this.orderListHistory=t.data},initWebSocket(){this.webSock&&this.webSock.close();const t="wss://www.tsaiduck.cn/ws";this.webSock=new WebSocket(t),this.webSock.onopen=function(){console.log("connected to "+t)},this.webSock.onmessage=function(t){console.log(t)},this.webSock.onclose=function(){console.log("close connect to"+t)},this.webSock.addEventListener("error",(function(t){console.log("WebSocket error: ",t)}))}},mounted(){this.getTodayOrder(),this.boxHeight=this.$refs.order.offsetHeight-95,this.$socket.emit("hello","hello")},watch:{active(t){"history"==t&&(this.getAllOrderVal.page=1,this.getOrderList())}},sockets:{newOrder(t){this.getTodayOrder()}}},at=st,rt=(0,d.Z)(at,q,B,!1,null,"b0c55202",null),nt=rt.exports,dt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"goodManage"},[e("div",{staticClass:"goodManage-title"},[e("span",{staticClass:"addGood",staticStyle:{width:"80px"},on:{click:t.addGood}},[t._v("添加商品")]),e("span",{staticStyle:{width:"160px"}},[t._v("名称")]),e("span",[t._v("价格")]),e("span",[t._v("类别")]),e("span",{staticStyle:{width:"240px"}},[t._v("信息")]),e("span",{staticStyle:{width:"80px"}},[t._v("操作")])]),e("div",{staticClass:"goodManage-content"},t._l(t.goodList,(function(o){return e("good",{key:o.good_id,attrs:{good:o},on:{changeGood:t.changeGood}})})),1),e("el-dialog",{attrs:{title:"商品管理",visible:t.showDialog,width:"40%","before-close":t.handleClose,top:"8vh"},on:{"update:visible":function(e){t.showDialog=e}}},[e("div",{staticClass:"dialog-content"},[e("div",{staticClass:"dialog-content-item"},[e("span",{staticClass:"dialog-content-item-name"},[t._v("商品名：")]),e("div",{staticClass:"dialog-content-item-input"},[e("el-input",{attrs:{size:"small",placeholder:"请输入商品名："},model:{value:t.good.good_name,callback:function(e){t.$set(t.good,"good_name",e)},expression:"good.good_name"}})],1)]),e("div",{staticClass:"dialog-content-item"},[e("span",{staticClass:"dialog-content-item-name"},[t._v("商品类别：")]),e("div",{staticClass:"dialog-content-item-input"},[e("el-select",{attrs:{placeholder:"请选择类别",size:"small"},model:{value:t.good.good_class,callback:function(e){t.$set(t.good,"good_class",e)},expression:"good.good_class"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"dialog-content-item"},[e("span",{staticClass:"dialog-content-item-name"},[t._v("商品价格：")]),e("div",{staticClass:"dialog-content-item-input"},[e("el-input",{attrs:{size:"small",placeholder:"请输入价格："},model:{value:t.good.good_price,callback:function(e){t.$set(t.good,"good_price",e)},expression:"good.good_price"}})],1)]),e("div",{staticClass:"dialog-content-item"},[e("span",{staticClass:"dialog-content-item-name"},[t._v("商品信息：")]),e("div",{staticClass:"dialog-content-item-textarea"},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:6},placeholder:"请输入商品信息"},model:{value:t.good.good_info,callback:function(e){t.$set(t.good,"good_info",e)},expression:"good.good_info"}})],1)]),e("div",{staticClass:"dialog-content-image"},[""==t.good.good_img_preview?e("div",{staticClass:"image-fake"},[e("span",{staticClass:"el-icon-plus"})]):e("div",{staticClass:"image-true"},[e("img",{staticClass:"image-true-item",attrs:{src:t.good.good_img_preview,alt:""}})]),e("input",{staticClass:"input-img",attrs:{type:"file",title:"请选择图片",accept:".png, .jpg, .jpeg"},on:{change:t.imgChange}})])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"warning"},on:{click:t.goodUpLoad}},[t._v("确 定")])],1)])],1)},ct=[],lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"good"},[e("div",{staticClass:"good-info"},[e("img",{attrs:{src:t.good.good_img,alt:""}}),e("span",{staticStyle:{width:"160px"}},[t._v(t._s(t.good.good_name))]),e("span",[t._v(t._s(t.good.good_price.toFixed(2)))]),e("span",[t._v(t._s(t.good.good_class))]),e("span",{staticStyle:{width:"240px"}},[t._v(t._s(t.good.good_info))]),e("div",{staticClass:"btn"},[e("span",{on:{click:function(e){return t.changeGood("change")}}},[t._v("修改")]),e("span",{on:{click:function(e){return t.changeGood("delete")}}},[t._v("删除")])])])])},gt=[],ut={props:{good:{type:Object}},methods:{changeGood(t){this.$emit("changeGood",{method:t,good:this.good})}}},ht=ut,pt=(0,d.Z)(ht,lt,gt,!1,null,"682fc6a0",null),_t=pt.exports,vt={components:{good:_t},data(){return{goodList:[],showDialog:!1,good:{},options:[{value:"奶茶",label:"奶茶"},{value:"口感",label:"口感"},{value:"新鲜",label:"新鲜"},{value:"冰沙",label:"冰沙"}]}},methods:{async getGoodList(){const{data:t}=await this.$http.get("https://www.tsaiduck.cn/api/goodlist");if(200!==t.meta.status)return this.$showMsg();this.goodList=t.data},changeGood(t){"change"==t.method?(this.good={good_name:t.good.good_name,good_info:t.good.good_info,good_price:t.good.good_price,good_class:t.good.good_class,good_img:t.good.good_img,good_img_preview:t.good.good_img,good_id:t.good.good_id},this.showDialog=!0):this.$alert("确定要删除该商品吗？","删除",{confirmButtonText:"确定",callback:e=>{"confirm"==e?this.goodDelete(t.good.good_id):this.$message({type:"error",message:"取消删除"})}})},handleClose(t){this.$confirm("确认关闭？").then((()=>{t()})).catch((()=>{}))},initGood(){this.good={good_name:"",good_info:"",good_price:"",good_class:"",good_img:"",good_img_preview:""}},addGood(){this.initGood(),this.showDialog=!0},imgChange(t){const e=new FileReader;e.readAsDataURL(t.target.files[0]),e.onload=()=>{this.good.good_img_preview=e.result},this.good.good_img=t.target.files[0]},async goodUpLoad(){this.showDialog=!1;const t=new FormData;this.good.good_id&&t.append("good_id",this.good.good_id),t.append("good_name",this.good.good_name),t.append("good_info",this.good.good_info),t.append("good_price",this.good.good_price),t.append("good_class",this.good.good_class),t.append("good_img",this.good.good_img);const{data:e}=await this.$http.post("/api/uploadImage",t,{"Content-Type":"multipart/form-data;"});if(200!==e.meta.status)return this.$showMsg();this.getGoodList()},async goodDelete(t){const{data:e}=await this.$http.get(`/api/deleteGood?good_id=${t}`);if(200!==e.meta.status)return this.$showMsg();this.$message({type:"success",message:"已删除"}),this.getGoodList()}},mounted(){this.getGoodList()}},ft=vt,mt=(0,d.Z)(ft,dt,ct,!1,null,"1f1bc53b",null),wt=mt.exports,Ct=function(){var t=this,e=t._self._c;return e("div",{staticClass:"purchase"},[e("div",{staticClass:"order"},t._l(t.goodList,(function(t){return e("purchase",{key:t.good_id,attrs:{good:t}})})),1),e("div",{ref:"cart",staticClass:"cart"},[e("div",{ref:"cartTitle",staticClass:"cart-title"},[t._v("已选商品")]),e("div",{staticClass:"cart-item-box",style:{height:t.cartItemBoxHeight+"px"}},t._l(t.cart,(function(o,i){return e("div",{key:i,staticClass:"cart-item"},[e("div",{staticClass:"cart-item-title"},[e("span",[t._v(t._s(i+1)+". "+t._s(o.good_name))]),e("span",[t._v("  ￥"+t._s(((Number(o.good_price)+o.etc.reduce(((t,e)=>t+e[1]),0))*Number(o.count)).toFixed(2)))])]),e("div",{staticClass:"cart-item-size"},[e("span",{staticClass:"choice-info"},[t._v(t._s(o.size)+"/"+t._s(o.ice)+"/"+t._s(o.sugar)+" "),t._l(o.etc,(function(o,i){return e("span",{key:i},[t._v("/"+t._s(o[0]))])}))],2)]),e("div",{staticClass:"count-selector"},[e("span",{staticClass:"counter",on:{click:function(e){return t.reduceCount(i)}}},[t._v("-")]),e("span",{staticStyle:{margin:"0 6px"}},[t._v(t._s(o.count))]),e("span",{staticClass:"counter",on:{click:function(e){return t.addCount(i)}}},[t._v("+")])])])})),0),e("div",{ref:"cartOrder",staticClass:"cart-order"},[e("div",{staticClass:"countAll"},[e("span",[t._v("共"+t._s(t.cart.reduce(((t,e)=>t+e.count),0))+"件商品，总计￥"),e("span",{staticStyle:{"font-size":"21px"}},[t._v(t._s(t.cart.reduce(((t,e)=>t+e.good_price*e.count+e.etc.reduce(((t,e)=>t+e[1]),0)*e.count),0).toFixed(2)))])])]),e("div",{staticClass:"craterOrder"},[e("el-button",{attrs:{type:"warning"},on:{click:t.createOrder}},[t._v("创建订单")])],1)])])])},bt=[],yt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"purchase-item"},[e("div",{staticClass:"item-box",on:{click:t.showDialog}},[e("span",[t._v(t._s(t.good.good_name))]),e("span",[t._v("￥"+t._s(Number(t.good.good_price).toFixed(2)))])]),e("el-dialog",{attrs:{title:t.good.good_name+`   ￥${(("中杯"==t.goodSize.size?t.good.good_price:t.good.good_price+2)+t.goodSize.etc.reduce(((t,e)=>t+e[1]),0)).toFixed(2)}`,visible:t.dialogVisible,width:"500px",top:"5vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t._l(t.sizeValue,(function(o,i){return e("div",{key:i,staticClass:"size-item"},[e("strong",[t._v(t._s(t.sizeTitle[i]))]),e("br"),e("div",{staticClass:"size-item-box"},t._l(o,(function(o,s){return e("span",{key:s,class:["size-span-item",Object.values(t.goodSize)[i]==o?"active":""],on:{click:function(e){return t.changeSize(i,o)}}},[t._v(t._s(o))])})),0)])})),e("div",{staticClass:"size-item"},[e("strong",[t._v("加料")]),e("br"),e("div",{staticClass:"size-item-box"},t._l(t.specification,(function(o,i){return e("span",{key:i,class:["size-span-item",t.goodSize.etc.find((t=>t==o))?"active":""],on:{click:function(e){return t.changeGoodSizeETC(o)}}},[t._v(t._s(o[0])+" ￥"+t._s(o[1]))])})),0)]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addToCart}},[t._v("加入购物车")])],1)],2)],1)},kt=[],xt={props:{good:{type:Object}},data(){return{dialogVisible:!1,sizeTitle:["杯型","冰度","糖度"],sizeValue:[["中杯","大杯"],["标准冰","少冰","去冰","常温","热饮"],["七分糖","全糖"]],specification:[["珍珠",0],["波霸",0],["野果",0],["红豆",0],["燕麦",1],["咖啡冻",2],["布丁",4],["芒果酱",6],["芋圆",2],["紫米",1],["去糖改蜜",5]],goodSize:{size:"中杯",ice:"标准冰",sugar:"七分糖",etc:[],count:1}}},methods:{...(0,u.OI)(["addCart"]),changeSize(t,e){for(let o in this.goodSize)Object.keys(this.goodSize)[t]==o&&(this.goodSize[o]=e)},changeGoodSizeETC(t){const e=this.goodSize.etc.indexOf(t);-1==e?this.goodSize.etc.push(t):this.goodSize.etc.splice(e,1)},showDialog(){this.goodSize={size:"中杯",ice:"标准冰",sugar:"七分糖",etc:[],count:1},this.dialogVisible=!0},addToCart(){this.dialogVisible=!1,this.goodSize.good_id=this.good.good_id,this.goodSize.good_name=this.good.good_name,this.goodSize.good_img=this.good.good_img,this.goodSize.good_price="中杯"==this.goodSize.size?this.good.good_price:this.good.good_price+2,this.addCart(this.goodSize)}}},Ot=xt,$t=(0,d.Z)(Ot,yt,kt,!1,null,"55e727cc",null),St=$t.exports,Lt={components:{purchase:St},data(){return{goodList:[],cartItemBoxHeight:0}},methods:{...(0,u.OI)(["addCount","reduceCount","clearCart"]),async getGoodList(){const{data:t}=await this.$http.get("/api/goodlist");if(200!==t.meta.status)return this.$showMsg();this.goodList=t.data},async createOrder(){const t={order_user_id:this.user.user_id,order_price:this.cart.reduce(((t,e)=>t+e.good_price*e.count+e.etc.reduce(((t,e)=>t+e[1]),0)*e.count),0).toFixed(2),order_info:"无",order_state:"已下单",order_take_way:"自取",order_count:this.cart.reduce(((t,e)=>t+e.count),0),cart:this.cart},{data:e}=await this.$http.post("/api/addorder",t);return 200!==e.meta.status?this.$showMsg("服务器发生错误","创建订单失败"):(this.clearCart(),this.$showMsg("创建订单完成","成功"))}},computed:{...(0,u.rn)(["cart","user"])},mounted(){this.getGoodList(),this.cartItemBoxHeight=this.$refs.cart.offsetHeight-this.$refs.cartTitle.offsetHeight-this.$refs.cartOrder.offsetHeight}},zt=Lt,It=(0,d.Z)(zt,Ct,bt,!1,null,"40bd6ff1",null),Tt=It.exports,Dt=function(){var t=this;t._self._c;return t._m(0)},Ht=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"login"},[e("div",{staticClass:"login-content"},[e("img",{attrs:{src:o(1695)}}),e("div",{staticClass:"login-box"},[e("h1",[t._v("404 您的页面走丢了")])])])])}],Vt={},Zt=Vt,Gt=(0,d.Z)(Zt,Dt,Ht,!1,null,"32cc2c98",null),At=Gt.exports;i["default"].use(g.ZP);const Mt=g.ZP.prototype.push;g.ZP.prototype.push=function(t){return Mt.call(this,t).catch((t=>t))};const jt=[{path:"/",component:w,redirect:"/login"},{path:"/login",component:w},{path:"/manage",component:A,meta:{requireAuth:!0},redirect:"/manage/screen",children:[{path:"screen",component:E,meta:{requireAuth:!0}},{path:"order",component:nt,meta:{requireAuth:!0}},{path:"good",component:wt,meta:{requireAuth:!0}},{path:"purchase",component:Tt,meta:{requireAuth:!0}}]},{path:"*",component:At}],Pt=new g.ZP({base:"",routes:jt});Pt.beforeEach(((t,e,o)=>{t.meta.requireAuth&&h.state.user.root<1?o("/login"):o()}));var Wt=Pt,Ft=o(4161),Et=o(8499),qt=o.n(Et),Bt=o(9557),Rt=o.n(Bt),Ut=o(2066);i["default"].config.productionTip=!1,i["default"].use(qt()),i["default"].use(new(Rt())({debug:!0,connection:(0,Ut.ZP)("wss://www.tsaiduck.cn")}));const Nt=Ft.Z.create({baseURL:"https://www.tsaiduck.cn",timeout:5e3});function Jt(t,e){this.$alert(t||"请刷新重试",e||"数据请求失败",{confirmButtonText:"确定"})}i["default"].prototype.$http=Nt,i["default"].prototype.$showMsg=Jt,new i["default"]({el:"#app",router:Wt,store:h,render:t=>t(l)}).$mount("#app")},1703:function(t,e,o){t.exports=o.p+"img/00245-3553923336--removebg-preview.a97b02e4.png"},1695:function(t,e,o){t.exports=o.p+"img/00245-3553923336-.32d49579.png"}},e={};function o(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=t,function(){o.amdO={}}(),function(){var t=[];o.O=function(e,i,s,a){if(!i){var r=1/0;for(l=0;l<t.length;l++){i=t[l][0],s=t[l][1],a=t[l][2];for(var n=!0,d=0;d<i.length;d++)(!1&a||r>=a)&&Object.keys(o.O).every((function(t){return o.O[t](i[d])}))?i.splice(d--,1):(n=!1,a<r&&(r=a));if(n){t.splice(l--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[i,s,a]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){o.p=""}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,a,r=i[0],n=i[1],d=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(d)var l=d(o)}for(e&&e(i);c<r.length;c++)a=r[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(l)},i=self["webpackChunkbibo_manage"]=self["webpackChunkbibo_manage"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(3677)}));i=o.O(i)})();
//# sourceMappingURL=app.b2cc4228.js.map